<script>
    $(document).ready(function(){
        var plantSelect = $('#plantSelect');
    
        $('#addLine').on('click', function(e){
            event.preventDefault();
            var plantId = plantSelect.val();
            var lineName = $('#lineName').val();
    
            if (plantId !== '') {
                $.ajax({
                    type: 'POST',
                    url: 'insertData.php',
                    data: {
                        plantId: plantId,
                        lineName: lineName,
                        work : 4
                    },
                    dataType: 'json',
                    success: function(response) {
                        if (response == 1) {
                            swal("Good job!", "Inserted Successfully!", "success");
                            $("#addLineForm")[0].reset();
                        } else if (response == 2) {
                            swal("Error!", "Enter Role Name!", "info");
                        }
                    },
                    error: function (error) {
                        console.error('Error:', error);
                    }
                });
            } else {
                swal("Error!", "Please Select a Plant!", "info");
            }
        });
    
        $('#plantSelect').on('change', function () {
            var plantId = $(this).val();
    
            $.ajax({
                type: 'POST',
                url: 'fetchData.php',
                data: { plantId: plantId, work: 4 },
                dataType: 'json',
                success: function (data) {
                    console.log(data);
                    var footerLinesContainer = $('#footerLines');
                    footerLinesContainer.empty();
    
                    var tableBody = $('#lineTableBody');
                    tableBody.empty();
    
                    $.each(data, function (index, line) {
                        // Create footer lines
                        var lineItem = $('<div class="rounded-3 me-2 px-3 py-2 footerDiv clickable"></div>');
                        var lineIcon = $('<iconify-icon icon="cil:object-ungroup" class="me-1 footerIcon" width="15"></iconify-icon>');
                        var lineLink = $('<a class="text-decoration-none me-1 line-link footeranchor clickable" href="#" role="button"></a>')
                            .text(line.line_name)
                            .attr('data-lineid', line.line_id);
    
                        lineItem.append(lineIcon, lineLink);
                        footerLinesContainer.append(lineItem);
    
                        // Create table cells
                        var row = $('<tr class="clickable"></tr>');
                        var cell = $('<td class="clickable"></td>').text(line.line_name).attr('data-lineid', line.line_id);
    
                        row.append(cell);
                        tableBody.append(row);
                    });
                },
                error: function (error) {
                    console.error('Error:', error);
                }
            });
        });
    
        // Click event for both footer lines and table cells
        $(document).on('click', '.clickable', function () {
        var lineId = $(this).data('lineid');
        console.log('Clicked:', lineId);
    
        // Remove styles from previously clicked items
        $('.clickable.clicked').removeClass('clicked');
    
        // Toggle styles for the clicked item
        $(this).toggleClass('clicked');
        $('#footerLines .line-link[data-lineid="' + lineId + '"]').parent().toggleClass('clicked');
        $('#footerLines .line-link[data-lineid="' + lineId + '"]').toggleClass('clicked');
        $('#footerLines .footerIcon[data-lineid="' + lineId + '"]').toggleClass('clicked');
    
        // Change background color for the table cell
        $('#lineTableBody td[data-lineid="' + lineId + '"]').toggleClass('clicked');
    });
    });
    </script>






(document).on('click', '.clickable', function () {
    var lineId = $(this).data('lineid');
    var plantId = $('#plantSelect').val(); 

    if (lineId !== undefined) {                
        $('.clickable.clicked').removeClass('clicked');

        $(this).toggleClass('clicked');
        $('#footerLines .line-link[data-lineid="' + lineId + '"]').parent().toggleClass('clicked');
        $('#footerLines .line-link[data-lineid="' + lineId + '"]').toggleClass('clicked');
        $('#footerLines .footerIcon[data-lineid="' + lineId + '"]').toggleClass('clicked');
        $('#lineTableBody td[data-lineid="' + lineId + '"]').toggleClass('clicked');


        var dynamicHeader = $('#dynamicHeader');
        dynamicHeader.empty();

        var div = $('<div class="rounded-3 me-5 px-1 py-2 ms-auto machineCss"></div>');
        var icon = $('<iconify-icon icon="ic:baseline-add" class="pe-1" width="19"></iconify-icon>');
        var link = $('<a class="text-decoration-none me-1 edit-machine" href="#" style="color: white; font-size: 14px;" role="button" data-bs-toggle="modal" data-bs-target="#machineModal"></a>')
        .attr('data-plantid', plantId)
        .attr('data-lineid', lineId)
        .text('MACHINE');

        div.append(icon, link);
        dynamicHeader.append(div);
    }

    fetchMachineData(lineId,plantId);
});



// function updateSelectAll() {
    //     var allChecked = $('.checkbox-group:checked').length === $('.checkbox-group').length;
    //     $('#selectAll').prop('checked', allChecked);
    // }

    // // Event handler for "Select All" checkbox
    // $('#selectAll').change(function () {
    //     $('.checkbox-group').prop('checked', $(this).prop('checked'));
    //     updateSelectAll();
    // });

    // // Event handler for individual checkboxes
    // $('.checkbox-group').change(function () {
    //     updateSelectAll();
    //     var checkedCount = $('.checkbox-group:checked').length;
    //     console.log('Number of checked checkboxes: ' + checkedCount);
    // });

    // Event handler for the "ADD" button in the modal